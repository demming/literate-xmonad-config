#!/usr/bin/env sh

# handle arguments
QUIET=false

if [ "$1" = "--quiet" ] || [ "$1" = "-q" ]; then
    QUIET=true
fi

function notify() {
    [ "$QUIET" = false ] && notify-send "$@"
}


# tangle the org file -- `ntangle` is much faster than the elisp implementation
# see [[https://github.com/OrgTangle/ntangle]]
ntangle src/config.org 1>/dev/null

stack build
status=$?

if [[ $status -ne 0 ]]; then
    notify --urgency=critical "XMonad" "Building failed!"
else
    notify "XMonad" "Build successful"
fi

exit $status
